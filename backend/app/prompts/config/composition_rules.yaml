# Prompt Composition Rules - Single-Use Compositions for LangGraph Orchestration
# Each composition maps to a single user prompt plus system prompts

compositions:
  # OCR Compositions
  ocr_whole_document_extraction:
    description: "Extract text from entire document with OCR"
    version: "1.0.0"
    system_prompts:
      - name: "ocr_processor"
        path: "system/domain/ocr_processor.md"
        priority: 100
        required: true
      - name: "australian_legal"
        path: "system/context/australian_legal.md"
        priority: 80
        required: true
    user_prompts:
      - "ocr_whole_document_extraction"

  ocr_text_diagram_insight:
    description: "Extract insights from text and diagram content"
    version: "1.0.0"
    system_prompts:
      - name: "ocr_processor"
        path: "system/domain/ocr_processor.md"
        priority: 100
        required: true
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 90
        required: true
    user_prompts:
      - "ocr_text_diagram_insight"

  # Analysis Compositions
  structure_analysis_only:
    description: "Analyze contract structure from extracted text"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "analysis/contract_structure"

  compliance_check_only:
    description: "Check legal compliance requirements"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "analysis/compliance_check"

  financial_analysis_only:
    description: "Analyze financial terms and obligations"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "analysis/financial_analysis"

  risk_assessment_only:
    description: "Assess contract risks and potential issues"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "workflow/contract_risk_assessment"

  recommendations_only:
    description: "Generate contract recommendations"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "workflow/contract_recommendations"

  # Semantic Analysis Compositions
  semantic_analysis_only:
    description: "Extract semantic meaning from diagrams"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "analysis/semantic_analysis"

  image_semantics_only:
    description: "Analyze image semantics and content"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "analysis/image_semantics"

  # Validation Compositions
  document_quality_validation_only:
    description: "Validate document quality and completeness"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
    user_prompts:
      - "validation/document_quality_validation"

  terms_validation_only:
    description: "Validate contract terms completeness"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
      - name: "australian_context"
        path: "system/context/australian_legal.md"
        priority: 90
        required: true
    user_prompts:
      - "validation/terms_completeness_validation"

  final_validation_only:
    description: "Perform final output validation"
    version: "1.0.0"
    system_prompts:
      - name: "legal_specialist"
        path: "system/domain/legal_specialist.md"
        priority: 100
        required: true
    user_prompts:
      - "validation/final_output_validation"

# Global composition settings (simplified)
global_settings:
  cache_ttl_seconds: 1800  # 30 minutes
  validation:
    validate_inputs: true
    validate_outputs: true

# State-specific system prompt overrides
state_overrides:
  NSW:
    system_prompt_overrides:
      australian_context: "system/context/state_specific/nsw_context.md"
  
  VIC:
    system_prompt_overrides:
      australian_context: "system/context/state_specific/vic_context.md"
  
  QLD:
    system_prompt_overrides:
      australian_context: "system/context/state_specific/qld_context.md"